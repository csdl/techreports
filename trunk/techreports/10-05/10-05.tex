%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -*- Mode: Latex -*- %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 10-05.tex --      IEEE Smart Grid Comm paper
%% Author          : Philip Johnson
%% Created On      : Mon Sep 23 11:52:28 2002
%% Last Modified By: Philip Johnson
%% Last Modified On: Fri Apr 16 12:00:21 2010
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%   Copyright (C) 2009 Philip Johnson
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 

%% Home page: http://www.ieee-smartgridcomm.org/submission.html

%% Must submit to one of the 12 symposia:
%% http://www.ieee-smartgridcomm.org/symposia.html

%% It appears that this is the most relevant symposia:
%% http://www.ieee-smartgridcomm.org/hibfn.html

%% For ``peer review mode'', do:
%%   \documentclass[conference,compsoc,peerreview]{IEEEtran}
%% and
%%   \IEEEpeerreviewmaketitle  (after the abstract).

%\documentclass[conference,compsoc,peerreview]{IEEEtran}
\documentclass[conference,compsoc]{IEEEtran}
\usepackage[final]{graphicx}
\usepackage{cite}
\usepackage{url}
% uncomment the % away on next line to produce the final camera-ready version
% and uncomment the \thispagestyle{empty} following \maketitle
%\pagestyle{empty}

\begin{document}

\title{WattDepot: An open source software ecosystem for enterprise-scale
  energy data collection, storage, analysis, and visualization}

\author{Robert S. Brewer\\
        Philip M. Johnson \\
\em     Collaborative Software Development Laboratory \\
        Department of Information and Computer Sciences \\
        University of Hawai'i \\
        Honolulu, HI 96822 \\
        \{rbrewer,johnson\}@hawaii.edu \\
}


\maketitle
%\IEEEpeerreviewmaketitle
%\thispagestyle{empty}

\begin{abstract}  % 200 words
  WattDepot is an open source, Internet-based, service-oriented framework 
  for collection, storage, analysis, and visualization of energy data.
  WattDepot differs from other energy management solutions in one or more
  of the following ways: it is not tied to any specific metering
  technology; it provides high-level support for meter aggregation and data
  interpolation; it supports carbon intensity analysis; it is
  architecturally decoupled from the underlying storage technology; it
  supports both hosted and local energy services; it can provide near-real
  time data collection and feedback; and the software is open source and
  freely available.  In this paper, we introduce the framework, provide
  examples of its use, and discuss its application to research and
  understanding of the Smart Grid.
\end{abstract}


\section{Introduction}
\label{sec:intro}

Recent interest in the Smart Grid has produced a wide variety of proposed
``open'' standards and technologies for energy data collection, storage,
and analysis.  Some prominent approaches include cloud-based services like
Google PowerMeter \cite{GooglePowerMeter} and Microsoft Hohm
\cite{MicrosoftHohm}, ``interoperable'' protocols and networking approaches
like Smart Energy 2.0 \cite{SmartEnergy2.0} and GridRouter Ecosystem
\cite{GridRouterEcosystem}, smart grid standards like IEEE SCC21
\cite{IEEESCC21} and Oasis Blue \cite{OasisBlue}, extensible energy
management devices like Control4's EMS 100 \cite{EMS100}, and home energy 
meters like the TED 5000 \cite{TED}.  There are also
``open source'' hardware platforms, such as OSHAN \cite{OSHAN}, and open
source software solutions for phasor data such as OpenPDC \cite{OpenPDC}.

For our research on behavioral change among energy consumers in a building
or home environment, we need a way to: (a) collect energy data from a
variety of meters with the possibility of near-real time (5-10 second)
feedback, (b) store the results in an internet-accessable repository; (c)
perform basic analyses on the raw data including aggregation and
interpolation, and (d) visualize the raw and processed data in a variety of
ways, including tables, gauges, trend lines, geo maps, heat maps, and so forth.

Unfortunately, we find that none of the current ``open'' technologies
satisfy these seemingly simple requirements. Either the technology is
designed for a specific brand of meter (such as the EMS 100 or TED 5000), or it does not
support near-real time feedback (such as Google PowerMeter and Microsoft
Hohm), or it focuses on utility issues (OpenPDC), or it focusses on
wire-level or hardware concerns (OSHAN, GridRouter Ecosystem).

Rather than implement a special purpose solution for our research, we
decided to leverage our prior experience in open source software
engineering measurement systems to design and implement an open source,
extensible, service-oriented framework for energy data collection, storage,
analysis, and visualization. Our framework, called WattDepot, consists of
three kinds of services:

\begin{itemize}
\item WattDepot {\em sensors}, each customized for a particular brand of
energy meter.  A sensor requests data from a meter according to the meter's
protocol, then sends it to a WattDepot repository for storage.

\item WattDepot {\em repositories}, which implement a REST \cite{REST} API
for accepting energy data sent from sensors and providing this sensor data
(or analyses based upon the data) to WattDepot clients.

\item WattDepot {\em clients}, which request data from WattDepot
repositories and either visualize the data or analyses directly to users or
provide the data to higher level energy services.
\end{itemize}

Figure \ref{fig:architecture} illustrates the architecture of the system.

\begin{figure*}[!th]
  \center
  \includegraphics[width=0.8\textwidth]{architecture.eps}
  \caption{\em \small Architecture of WattDepot: sensors obtain data from
    meters on consumption or generation, transmit their findings to a
    server, which is queried by clients to present visualizations or analyses.}
  \label{fig:architecture}
\end{figure*} 


For example, consider a University that wants to implement a dorm energy
competition in which energy meters will be installed on each floor of the
dorm and residents of each floor will compete against each other to see who
can reduce their energy the most.  Prior to WattDepot, one could either buy a
proprietary, ``black box'' solution such as the Building Dashboard from
Lucid Design Group and be restricted to the set of meters and analyses they
support, or else start from scratch and build all of the energy data
collection, analysis, and visualization services.  WattDepot provides an
alternative approach, in which collection, storage, and analysis
capabilities are freely available and amenable to integration within a web
application developed by the user.  For those with some software
development capability, this can be a lower cost solution and/or support
customization beyond the ability of current proprietary solutions.

WattDepot services are designed at the ``enterprise'' scale as opposed to
the ``home'' or ``utility'' scales.  By home scale, we mean systems like
the TED 5000, which are designed to collect and analyze data about a single
residence, typically through a simple ``dashboard'' interface that runs on
the user's local area network and/or power line.  WattDepot is designed to
collect, store, and analyze data from a wider range of locations using the
Internet as the transmission mechanism, and our performance analysis tests
indicate that it can easily process several thousand sensor data storage
requests per minute given adequate network bandwidth.  On the other hand,
by utility scale, we mean systems that can collect and store grid-level
data comprising tens or hundreds of thousands of residences, with
revenue-grade measurement, hardened storage, and security mechanisms.
WattDepot is not intended for these more rigorous utility-level
requirements.  Our goal for WattDepot is to provide a mechanism to
accelerate innovative research and development in energy analysis and
visualization by providing an extensible architecture and well documented,
open source software platform.

The next section of this paper introduces the basic components of
WattDepot. Following this we describe some of our initial experiences with
the framework and conclude with our future directions. 

\section{WattDepot Services}

\subsection{Sensors}

Electricity can be generated and/or consumed by a wide variety of devices
and monitored by a wide variety of metering technologies.  Many energy
management software systems are tied to a particular energy device and/or
meter; indeed, they are often marketed as an accessory to the hardware.  For
example, a solar panel company might provide software for storing data
about the power generated by the panel and simple visualizations of the
power generated over time.

The design of WattDepot attempts to make the software as independent from
the energy hardware devices as possible.  In WattDepot, it is the device
that is the accessory to the software.  To achieve this independence, the
WattDepot architecture includes ``sensors'', or small software processes
that query any given energy device according to its native protocol,
collect standard information, and then send it to a WattDepot server using
the Internet and the RESTful WattDepot HTTP protocol.  This design means
that new energy devices can be integrated easily into the WattDepot
software ecosystem just by writing the sensor interface.  The use of a
RESTful HTTP protocol for communication with the WattDepot server means
that the sensor can be implemented in any programming language.

We have implemented WattDepot sensors for the TED 5000 home energy device, 
the BMO building management meter, and for the Aquivim energy meter. This
latter sensor is particularly interesting because it is communicates with the
meter through the standard ModBus/TCP protocol.  The sensor is designed in 
a modular way so that it is easy to customize to support other meters that 
communicate using ModBus/TCP.

Sensors transmit data to a WattDepot server using a standardized, published
protocol, as discussed next.

\subsection{Servers}

A WattDepot server accepts raw energy data from devices (via sensors) and
makes this data (or analyses based upon it) available to clients.  The
WattDepot server implements a variety of design decisions intended to
improve its generality, reusability, and extensibility, including: (1) a
RESTful API, (2) a pluggable back-end database, (3) aggregation via
``virtual'' sources, (4) data interpolation, and (5) multiple
representations.

{\em RESTful API.} WattDepot conforms to modern web service design best
practices by providing a RESTful API.  REST (Representational State
Transfer) \cite{REST} is a specification paradigm, which, when applied to
web services, generally results in more easily usable and extensible
communication than alternatives such as SOAP. The details of RESTful design
are beyond the scope of this paper, but some of the implications are that
URLs can serve as unique identifiers for energy data and that HTTP commands
such as PUT, POST, GET, and DELETE are used to add, amend, retrieve, and
delete energy data. The WattDepot API \cite{WattDepotAPI} provides more
details and a full specification of the supported operations.

{\em Pluggable back-end database.} The WattDepot server implements an
abstraction layer that enables the server to be built with a variety of
different persistence mechanisms.  By default, WattDepot uses the Apache
Derby relational database, which is a high performance, embedded database
written in Java.  However, WattDepot can be ported to other relational or
non-relational database systems by implementing an interface and setting some 
run-time configuration parameters. 

{\em Aggregation via virtual sources.} The data from a single physical
meter is generally represented in WattDepot as a ``Source''.  Each
WattDepot Source can indicate the power generated or consumed by that
device at any moment in time, the energy generated or consumed by that
device over a period of time, the carbon intensity associated with that
device, and other features.  In addition to this one-to-one correspondance,
WattDepot also supports the definition of ``virtual'' Sources, which are
Sources defined as the aggregation of other Sources.  For example, a floor
on a building might have two meters collecting data about energy
consumption for the two sections of the floor.  WattDepot allows users to
define a virtual Source representing the aggregation of the data stream
from the two meters.  This virtual Source thus represents the total energy
consumption for the floor. Virtual Sources can be arranged in a hierarchy,
such that the virtual Sources for each floor in the building can themselves
be contained in a virtual Source representing the entire building's energy
consumption.

{\em Data interpolation.} One common initial roadblock to analyzing energy
data collected from multiple sources is the ``timestamp problem''. For
example, assume that energy consumption on a building floor is collected by
two meters, and that energy data is collected from those meters becomes
available approximately every 15 minutes, but the timestamps associated
with the data for a given time period differ by a minute or two.
Determining the aggregate energy consumption is no longer a simple matter
of importing the two data sets into a spreadsheet and using a summation
macro, because the timestamps from the two meters do not ``match up''.
WattDepot addresses this problem by providing automatic interpolation. For
example, assume a meter sent energy data at roughly 30 minute intervals:
11:23am, 11:56am, 12:25pm, and 1:01pm.  You can request the energy consumed
by this Source between 12:00pm and 1:00pm, for example, and WattDepot will
automatically interpolate the raw data values to provide an estimate for
the interval of interest.  Automatic interpolation enables virtual Sources
to return reasonable values even when its constituent Sources send data at
different times and with different frequencies.  Figure \ref{fig:visualizer}
illustrates both virtual sources and data interpolation. 

\begin{figure*}[!th]
  \center
  \includegraphics[width=0.6\textwidth]{visualizer.eps}
  \caption{\em \small The WattDepot Visualizer client displaying a virtual Source
    and its two constituent physical sources. Data values are interpolated.}
  \label{fig:visualizer}
\end{figure*} 

{\em Multiple representations.} One benefit of a RESTful architecture is
the separation of a ``resource'' from its ``representation''.  In
WattDepot, this means that data and analyses for a given Source can be
provided in different ways, depending upon the needs of the client.  So
far, WattDepot can provide data to clients using XML, JSON (the format
supported by Google Visualizations), and CSV (comma-separated values),
which is useful for importing WattDepot data into other tools for
additional analysis.

\subsection{Clients}
\label{sec:clients}



{\em This section will talk about the various clients, including the CLI,
  the Wicket app, and the various google gadgets.}

\section{Applications}

\subsection{Simulations}

\subsection{Dorm Energy Competition}

\subsection{Data storage and normalization}

\section{Future Directions}

{\em Micro-grids? Smart homes? Bayesian networks? Cloud-based persistence?}

\bibliographystyle{IEEEtran}
\bibliography{smartconsumer}
\end{document}











